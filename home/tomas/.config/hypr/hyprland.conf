source = colours.conf
$mainMod = SUPER

# monitors
$dpmonitor = DP-1
$hdmimonitor = HDMI-A-1

monitorv2 {
  output = $dpmonitor
  mode = highres@highrr
  position = 0x0
  scale = 1.00
  bitdepth = 10

  supports_wide_color = 1
  supports_hdr = 1
  sdr_min_luminance = 0.005
  sdr_max_luminance = 250
  min_luminance = 0.018
  max_luminance = 1156
  max_avg_luminance = 1156
  sdrbrightness = 1.3
  sdrsaturation = 1.0
}

monitorv2 {
  output = $hdmimonitor
  mode = highres@highrr
  position = auto-left
  scale = 1.00
}

workspace = 1, monitor:$dpmonitor
workspace = 2, monitor:$dpmonitor
workspace = 3, monitor:$hdmimonitor
workspace = 4, monitor:$hdmimonitor

# default programs
$terminal = sh -c 'uwsm-app -- kitten @ --to unix:/tmp/kitty.socket launch --type=os-window --cwd=current || uwsm-app -- kitty --single-instance --listen-on unix:/tmp/kitty.socket'
$menu = uwsm-app -- $(wofi --show drun --define=drun-print_desktop_file=true)
$browser = uwsm-app -- firefox
$fileManager = uwsm-app -- dolphin

# autostart
exec-once = set-theme dark
exec-once = hyprpm reload -n

exec-once = uwsm-app -- opensnitch-ui --background
exec-once = uwsm-app -- wlsunset -t 3500 -l 49.6 -L 17.25
exec-once = uwsm-app -- kdeconnectd

exec-once = $browser
exec-once = uwsm-app -- thunderbird

# clipboard manager
exec-once = uwsm-app -- wl-paste --type text --watch cliphist store
exec-once = uwsm-app -- wl-paste --type image --watch cliphist store
bind = SUPER, V, exec, cliphist list | wofi --dmenu --prompt "Clipboard history" | cliphist decode | wl-copy

general {
    gaps_in = 9
    gaps_out = 9

    border_size = 0
    col.inactive_border = $colorGuiBg
    col.active_border = $colorGuiHint

    resize_on_border = true

    layout = scrolling

    snap {
        enabled = true
        window_gap = 30
        monitor_gap = 30
    }
}

decoration {
    rounding = 10

    blur {
        enabled = true
        passes = 3
        size = 16
    }

    shadow {
        enabled = true
        range = 5
        render_power = 2
        offset = 1 1
    }
}
animations {
    enabled = true
    animation = windows, 1, 3, default
    animation = fade, 1, 3, default
}

master {
    new_status = slave
    mfact = 0.55

    bind = $mainMod, h, layoutmsg, focusmaster
    bind = $mainMod SHIFT, h, layoutmsg, swapwithmaster
    bind = $mainMod, j, layoutmsg, cyclenext
    bind = $mainMod, k, layoutmsg, cycleprev
    bind = $mainMod SHIFT, j, layoutmsg, swapnext noloop
    bind = $mainMod SHIFT, k, layoutmsg, swapprev noloop
    bind = $mainMod SHIFT, l, layoutmsg, orientationcycle left top
}

ecosystem {
    enforce_permissions = true

    permission = /usr/bin/grim, screencopy, allow
    permission = /usr/bin/hyprpicker, screencopy, allow
    permission = /usr/(lib|libexec|lib64)/xdg-desktop-portal-hyprland, screencopy, allow
    permission = /usr/bin/hyprlock, screencopy, allow

    permission = /var/cache/hyprpm/tomas/hyprland-plugins/.*.so, plugin, allow
    permission = /var/cache/hyprpm/tomas/Hyprspace/Hyprspace.so, plugin, allow
}

misc {
    font_family = Ubuntu

    force_default_wallpaper = 0
    disable_splash_rendering = true
    disable_hyprland_logo = true

    enable_swallow = true
    swallow_regex = ^(Alacritty|kitty|footclient)$
    swallow_exception_regex = ^(wev)$

    new_window_takes_over_fullscreen = 2
    allow_session_lock_restore = true
    middle_click_paste = false
}

input {
    kb_layout = cz
    kb_variant = coder
    numlock_by_default = true
    follow_mouse = 2
}

cursor {
  default_monitor = $dpmonitor
  hide_on_key_press = true
}

binds {
  scroll_event_delay = 1
}

plugin {
  # https://github.com/hyprwm/hyprland-plugins
  hyprscrolling {
    fullscreen_on_one_column = true
    focus_fit_method = 0
    follow_focus = true

    $column1 = 0.333
    $column2 = 0.48
    $column3 = 0.667
    $column4 = 0.95
    column_width = $column2
    explicit_column_widths = $column1, $column2, $column3, $column4

    bind = $mainMod, h, layoutmsg, focus l
    bind = $mainMod, l, layoutmsg, focus r
    bind = , mouse:275, layoutmsg, focus r
    bind = , mouse:276, layoutmsg, focus l
    bind = Alt, tab, layoutmsg, focus r
    bind = Alt SHIFT, tab, layoutmsg, focus l

    bind = $mainMod, j, layoutmsg, focus d
    bind = $mainMod, k, layoutmsg, focus u

    bind = $mainMod, bracketleft, layoutmsg, colresize -conf
    bind = $mainMod, bracketright, layoutmsg, colresize +conf
    bind = $mainMod, 1, layoutmsg, colresize $column1
    bind = $mainMod, 2, layoutmsg, colresize $column2
    bind = $mainMod, 3, layoutmsg, colresize $column3
    bind = $mainMod, 4, layoutmsg, colresize $column4

    bind = $mainMod ALT, j, layoutmsg, movewindowto d
    bind = $mainMod ALT, k, layoutmsg, movewindowto u
    bind = $mainMod ALT, h, layoutmsg, movewindowto l
    bind = $mainMod ALT, l, layoutmsg, movewindowto r

    bind = $mainMod SHIFT, h, layoutmsg, swapcol l
    bind = $mainMod SHIFT, l, layoutmsg, swapcol r
    bind = $mainMod SHIFT, j, layoutmsg, movewindowto d
    bind = $mainMod SHIFT, k, layoutmsg, movewindowto u

    bind = $mainMod, m, layoutmsg, fit active
    bind = $mainMod SHIFT, m, layoutmsg, colresize $column4
    bind = $mainMod, u, layoutmsg, fit visible
  }
}

bind = $mainMod SHIFT, r, exec, hyprctl reload

bind = $mainMod, return, exec, $terminal
bind = $mainMod, o, exec, $menu
bind = $mainMod SHIFT, C, killactive

bind = $mainMod, f, fullscreen
bind = $mainMod, space, togglefloating

bindm = $mainMod, mouse:272, movewindow
bindm = $mainMod, mouse:273, resizewindow
bind = $mainMod, mouse:274, togglefloating

bind = $mainMod SHIFT, bracketleft, resizeactive,  0%  10%
bind = $mainMod SHIFT, bracketright, resizeactive, 0% -10%

bind = $mainMod, Delete, exec, uwsm-app -- hyprlock
bind = $mainMod SHIFT, p, exec, keepassxc-wofi
bind = $mainMod, w, exec, wofi-window

bind = $mainMod, g, exec, uwsm-app -- xdg-open "$(fd -L . $HOME | sort -h | wofi)"
bind = $mainMod, e, exec, cat ~/.local/share/emojis.txt | wofi --prompt 'Select emoji' | cut -f 1 -d ' ' | wl-copy -n

bind = $mainMod, t, exec, set-theme
bind = $mainMod, comma, exec, hyprpaper-random
bind = $mainMod SHIFT, g, exec, hyprgamemode

bind = $mainMod, n, exec, makoctl dismiss
bind = $mainMod SHIFT, n, exec, makoctl dismiss -a
bind = $mainMod, d, exec, notify-clock

bind = $mainMod, s, exec, grimblast --freeze copysave area "${HOME}/Pictures/Screenshots/$(date '+%Y-%m-%d_%H:%M:%S')_area.png"
bind = $mainMod SHIFT, s, exec, grimblast --notify copysave output "${HOME}/Pictures/Screenshots/$(date '+%Y-%m-%d_%H:%M:%S')_output.png"

bind = $mainMod, left, exec, ddcutil --bus 7 setvcp 10 - 5
bind = $mainMod, right, exec, ddcutil --bus 7 setvcp 10 + 5
bind = $mainMod SHIFT, left, exec, ddcutil --bus 7 setvcp 10 0
bind = $mainMod SHIFT, right, exec, ddcutil --bus 7 setvcp 10 100
bind = $mainMod, down, exec, ddcutil --bus 4 setvcp 10 - 5
bind = $mainMod, up, exec, ddcutil --bus 4 setvcp 10 + 5
bind = $mainMod SHIFT, down, exec, ddcutil --bus 4 setvcp 10 0
bind = $mainMod SHIFT, up, exec, ddcutil --bus 4 setvcp 10 100

bind = $mainMod, tab, workspace, m+1
bind = $mainMod, z, workspace, emptym
bind = $mainMod SHIFT, tab, movetoworkspace, m+1
bind = $mainMod SHIFT, z, movetoworkspace, emptym

bind = $mainMod, i, focusmonitor, +1
bind = $mainMod SHIFT, i, movewindow, mon:+1
bind = $mainMod, backslash, swapactiveworkspaces, $dpmonitor $hdmimonitor

bind = $mainMod, mouse_down, exec, hyprctl -q keyword cursor:zoom_factor $(hyprctl getoption cursor:zoom_factor | awk '/^float.*/ {print $2 * 1.1}')
bind = $mainMod, mouse_up, exec, hyprctl -q keyword cursor:zoom_factor $(hyprctl getoption cursor:zoom_factor | awk '/^float.*/ {print $2 * 0.9}')

bind = $mainMod CTRL, p, exec, keepassxc ~/.local/share/keepass/k.kdbx
bind = $mainMod CTRL, b, exec, $browser
bind = $mainMod CTRL, f, exec, $fileManager

# Ignore maximize requests from apps
windowrule = suppressevent maximize, class:.*

# Fix some dragging issues with XWayland
windowrule = nofocus,class:^$,title:^$,xwayland:1,floating:1,fullscreen:0,pinned:0

experimental {
  xx_color_management_v4 = true
}

xwayland {
    force_zero_scaling = true
}

debug {
  full_cm_proto = true # gamescope needs this to run; https://github.com/ValveSoftware/gamescope/issues/1825#issuecomment-2883202415
}

# nvidia stuff
windowrulev2 = stayfocused, title:^()$,class:^(steam)$
windowrulev2 = minsize 1 1, title:^()$,class:^(steam)
